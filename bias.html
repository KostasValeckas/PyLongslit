<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bias &#8212; PyLongslit  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dark current subtraction" href="dark_current.html" />
    <link rel="prev" title="Configuration files" href="configuration_file.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="bias">
<span id="id1"></span><h1>Bias<a class="headerlink" href="#bias" title="Link to this heading">¶</a></h1>
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">¶</a></h2>
<p>The command for running the bias procedure is called by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pylongslit_bias<span class="w"> </span>PATH_TO_CONFIG_FILE
</pre></div>
</div>
<p>The bias procedure produces a master bias frame <code class="docutils literal notranslate"><span class="pre">master_bias.fits</span></code> by median-combining the raw frames,
and places it in the  output directory specified in the <a class="reference internal" href="configuration_file.html#conf"><span class="std std-ref">configuration file</span></a>. Median combination
is used as it is robust against outliers in the raw data.</p>
<section id="overscan-subtraction">
<h3>Overscan subtraction<a class="headerlink" href="#overscan-subtraction" title="Link to this heading">¶</a></h3>
<p>If overscan use is enabled in the configuration file, the bias procedure
will estimate a mean overscan bias individually for every raw bias frame
and subtract it, before median-combining the bias frames. In this case,
the overscan bias is used as an estimate for the baseline bias-level frame-wise, while
the master bias frame is used to correct for the 2D bias structure/gradient
through the detector. With overscan subtraction, the master bias can show negative values,
as these values correspond to an offset from the baseline bias-level,
and not the absolute bias level. <strong>If you choose to disable the overscan subtraction
in the</strong> <a class="reference internal" href="configuration_file.html#conf"><span class="std std-ref">configuration file</span></a> (not recommended) <strong>, it is important that
you do not enable it at any point during the other data-processing steps</strong>.</p>
</section>
</section>
<section id="quality-assessment">
<h2>Quality Assessment<a class="headerlink" href="#quality-assessment" title="Link to this heading">¶</a></h2>
<p>The bias procedure will show the final master bias and the error upon exiting. You can
press <code class="docutils literal notranslate"><span class="pre">h</span></code> to normalize the master bias to see the structure of the bias
frame more clearly. How the bias should look like depends on the detector,
and most instruments have archived master bias frames that can be used as a reference.
Overall, you are expecting to see a smooth 2D structure (example of normalized master bias from the SDSS_J213510+2728
tutorial data):</p>
<a class="reference internal image-reference" href="_images/bias_example.png"><img alt="_images/bias_example.png" class="align-center" src="_images/bias_example.png" style="width: 100%;" />
</a>
</section>
<section id="parameter-options">
<h2>Parameter options<a class="headerlink" href="#parameter-options" title="Link to this heading">¶</a></h2>
<p>The relevant parameters for the bias procedure are (with example values):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;detector&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;overscan&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;use_overscan&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;overscan_x_start&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;overscan_x_end&quot;</span><span class="p">:</span> <span class="mi">499</span><span class="p">,</span>
        <span class="s2">&quot;overscan_y_start&quot;</span><span class="p">:</span> <span class="mi">2064</span><span class="p">,</span>
        <span class="s2">&quot;overscan_y_end&quot;</span><span class="p">:</span> <span class="mi">2102</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="s2">&quot;bias&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bias_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/kostas/Documents/PyLongslit_dev/SDSS_J213510+2728/bias&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bootstrap_errors&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you set <code class="docutils literal notranslate"><span class="pre">&quot;use_overscan&quot;:</span> <span class="pre">false</span></code>, the overscan subtraction will be skipped,
and you do not need to worry about the rest of the overscan parameters. However,
if you set <code class="docutils literal notranslate"><span class="pre">&quot;use_overscan&quot;:</span> <span class="pre">true</span></code>, you need to specify the overscan region
in the raw frames by defining a rectangular region with the parameters
<code class="docutils literal notranslate"><span class="pre">&quot;overscan_x_start&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;overscan_x_end&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;overscan_y_start&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;overscan_y_end&quot;</span></code>,
with the orientation the raw data is provided in. You can call the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pylongslit_check_config<span class="w"> </span>PATH_TO_CONFIG_FILE
</pre></div>
</div>
<p>in order to plot the defined overscan region on a raw flat-field frame
(the example is from the SDSS_J213510+2728 tutorial data):</p>
<a class="reference internal image-reference" href="_images/overscan.png"><img alt="_images/overscan.png" class="align-center" src="_images/overscan.png" style="width: 100%;" />
</a>
<p>For the <code class="docutils literal notranslate"><span class="pre">&quot;bias_dir&quot;</span></code> parameter, you need to specify the path to the directory
where the raw bias frames are stored. Make sure only bias frames are stored in this directory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;bootstrap_errors&quot;</span></code> parameter can be set to true in order to estimate the error on the
master bias frame using bootstrap resampling. This is useful if you have
a small number of bias frames, and want to estimate the error with a higher
precision. However, the bootstrap resampling is computationally expensive,
and takes a while - especially for larger detectors. Whether bootstrap resampling is
necessary depends on the detector and your science case - if you do not
need very high precision on the error, or if you know your detector has a
stable bias level, you can mostly set <code class="docutils literal notranslate"><span class="pre">&quot;bootstrap_errors&quot;</span></code> to false. You can
read more about how the software estimates errors in the <a class="reference internal" href="uncertainties.html#uncertainties"><span class="std std-ref">note on uncertainties</span></a>.</p>
</section>
<section id="for-users-new-to-data-reduction-short-introduction-to-detector-bias">
<h2>For users new to data reduction - short introduction to detector bias<a class="headerlink" href="#for-users-new-to-data-reduction-short-introduction-to-detector-bias" title="Link to this heading">¶</a></h2>
<p>For technical reasons, a CCD detector is set-up to produce a baseline signal upon
data readout. This means that a readout of an empty detector (no exposure) will
produce a signal that is not zero. This signal is called the bias level, and
it is a constant offset that is added to the signal produced by the incoming photons.
In data processing, the bias level must be subtracted, such that 0 counts
on the detector correspond to 0 incoming photons.</p>
<p>The bias is estimated by taking a series of bias frames - frames with no exposure time.
The bias frames can then be analyzed to estimate the bias level at every pixel -
this is usually referred to as the master bias frame. For some detectors, extra
readout cycles are performed to readout pseudo-pixels that are not physical pixels on the detector -
this is done for every frame (not only bias frames). These pseudo-pixels are called the overscan, and they have a value that corresponds
to the bias level for the frame the overscan is attached to. The overscan regions can be used to estimate the bias level
frame-wise (as the bias level can drift through the night), while the master bias is a statistical estimate of the bias level
acquired by combination of all the bias frames (these are usually taken before or/and after the observing night).</p>
<p>The bias frames carry the information about the bias level for every pixel individually, but
only at the time the frames were taken. The overscan regions carry the information
about the bias level for the exact time the frame was taken, but only as an
overall estimate for the frame. Therefore, <strong>a combination of both the overscan
and the master bias is preferred</strong>. The software can run without using the overscan (this is set in the <a class="reference internal" href="configuration_file.html#conf"><span class="std std-ref">configuration file</span></a>),
but this method will ignore any bias level drift between the individual frames. Only using the overscan is not allowed
in the software, as the mean overscan completely neglects the 2D structure of the bias.</p>
<hr class="docutils" />
<p>Next pipeline step → <a class="reference internal" href="dark_current.html#dark"><span class="std std-ref">Setting up for dark current subtraction</span></a></p>
<p><a class="reference internal" href="general_notes.html#general-notes"><span class="std std-ref">General Notes on using the pipeline</span></a></p>
<p><a class="reference internal" href="configuration_file.html#conf"><span class="std std-ref">General info on the configuration file</span></a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyLongslit</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="getting_started.html">Getting started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#downloading-the-tutorial-data">Downloading the tutorial data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="getting_started.html#tutorial">Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Overview of all pipeline procedures and their products</a></li>
<li class="toctree-l1"><a class="reference internal" href="tested_instruments.html">Tested Instruments and Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="special_use_cases.html">Special Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">Interested in developing?</a></li>
<li class="toctree-l1"><a class="reference internal" href="uncertainties.html">Note on how the software estimates uncertainties</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="getting_started.html">Getting started</a><ul>
      <li>Previous: <a href="configuration_file.html" title="previous chapter">Configuration files</a></li>
      <li>Next: <a href="dark_current.html" title="next chapter">Dark current subtraction</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/bias.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>