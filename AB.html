<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A-B Background subtraction &#8212; PyLongslit  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cropping of images" href="crop.html" />
    <link rel="prev" title="Cosmic ray removal" href="crr.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="a-b-background-subtraction">
<span id="ab"></span><h1>A-B Background subtraction<a class="headerlink" href="#a-b-background-subtraction" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This procedure can only be performed if you have several frames of the same object,
taken continuously one after another, with the same exposure time, but where the
objects’ spatial position is with purpose shifted slightly on the detector. <strong>Skip this procedure if you do not have
such frames.</strong></p>
</div>
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">¶</a></h2>
<p>The procedure is called by the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pylongslit_subtract_background<span class="w"> </span>PATH_TO_CONFIG_FILE
</pre></div>
</div>
<p>The procedure will perform A-B background subtraction for the pairs of reduced
files as provided in the configuration file. The procedure will alter the
reduced files in-place.</p>
</section>
<section id="quality-assesment">
<h2>Quality Assesment<a class="headerlink" href="#quality-assesment" title="Link to this heading">¶</a></h2>
<p>The procedure will show the frame prior and after background subtraction. An example for
the SDSS_J213510+2728 dataset is shown below:</p>
<a class="reference internal image-reference" href="_images/good_ab.png"><img alt="_images/good_ab.png" class="align-center" src="_images/good_ab.png" style="width: 100%;" />
</a>
<p>Besides a clear reduction of the sky-background, the most important thing to ensure is that the object from the B frame (the negative) is
not laying too close to the object in the A frame (the positive), such so some of the
A object signal is subtracted by the B object signal. The software takes a
sample of 1d-slices to help investigate this:</p>
<a class="reference internal image-reference" href="_images/whole_AB_slice.png"><img alt="_images/whole_AB_slice.png" class="align-center" src="_images/whole_AB_slice.png" style="width: 100%;" />
</a>
<p>Zooming on the the negative and positive object signal, you can see that they
are not overlapping:</p>
<a class="reference internal image-reference" href="_images/good_AB_slice.png"><img alt="_images/good_AB_slice.png" class="align-center" src="_images/good_AB_slice.png" style="width: 100%;" />
</a>
<p>The GQ1218+0832 tutorial dataset shows an example where the traces are overlapping:</p>
<a class="reference internal image-reference" href="_images/bad_AB_slice.png"><img alt="_images/bad_AB_slice.png" class="align-center" src="_images/bad_AB_slice.png" style="width: 100%;" />
</a>
<p>Hence, <strong>you should not perform A-B subtraction on this dataset</strong>. Even though
the traces seem to be just touching, the subtraction will still remove some of the
object signal.</p>
<p>If this is the case, reset
(perform the <a class="reference internal" href="reduce.html#reduce"><span class="std std-ref">reduction procedure</span></a> again) and move on to the next
step without A-B subtraction.</p>
</section>
<section id="parameter-options">
<h2>Parameter options<a class="headerlink" href="#parameter-options" title="Link to this heading">¶</a></h2>
<p>The parameters for this procedure are providing the pairs of reduced files that should be
subtracted from each other. Example from the SDSS_J213510+2728 dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;background_sub&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;pairs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;ALHh080251.fits&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;ALHh080252.fits&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;ALHh080252.fits&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;ALHh080251.fits&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can insert any number of pairs, as long as they are tagged with numbers (in string format)
starting from 1 and increasing by 1 for each pair (1,2,3…). This helps the software
to keep track of the pairs. The A and B files should be the filenames of the reduced files
(their raw filenames).</p>
</section>
<section id="for-users-new-to-data-reduction-short-introduction-to-a-b-background-subtraction">
<h2>For users new to data reduction - short introduction to A-B background subtraction<a class="headerlink" href="#for-users-new-to-data-reduction-short-introduction-to-a-b-background-subtraction" title="Link to this heading">¶</a></h2>
<p>A-B background subtraction is a technique used to remove the sky-background from
spectra. The idea is to take two frames of the same object, with the same exposure time,
but where the object is shifted slightly on the detector. This way, the sky gets recorded
in the spatial position of the object. Example: if for frame A the object is
at spatial pixel 100, the object can be moved to spatial pixel 110 for the frame B, and
now frame B has the sky background recorded at spatial pixel 100. Subtracting frame B from frame A
will remove the sky-background from the object signal. The procedure is called A-B subtraction.</p>
</section>
<section id="for-users-new-to-data-reduction-short-introduction-to-sky-background">
<h2>For users new to data reduction - short introduction to sky background<a class="headerlink" href="#for-users-new-to-data-reduction-short-introduction-to-sky-background" title="Link to this heading">¶</a></h2>
<p>Sky background is the light from the sky and the atmosphere that is recorded by the detector together
with the object spectrum. This background light covers
the whole slit, and the bacground therefore shows itself as lines through the whole spatial direction
(see above figures). The sky background consists both of strong sky lines (emission lines from the sky) and
a continuum background. These sky lines/background are mixed into the object signal, and must be removed.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyLongslit</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="getting_started.html">Getting started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#downloading-the-tutorial-data">Downloading the tutorial data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="getting_started.html#tutorial">Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">Interested in developing?</a></li>
<li class="toctree-l1"><a class="reference internal" href="uncertainties.html">Note on how the software estimates uncertainties</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="getting_started.html">Getting started</a><ul>
      <li>Previous: <a href="crr.html" title="previous chapter">Cosmic ray removal</a></li>
      <li>Next: <a href="crop.html" title="next chapter">Cropping of images</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/AB.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>