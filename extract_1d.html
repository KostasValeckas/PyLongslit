<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extracting 1D spectrum &#8212; PyLongslit  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sensitivity function" href="sensfunction.html" />
    <link rel="prev" title="Object Tracing" href="objtrace.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="extracting-1d-spectrum">
<span id="extract-1d"></span><h1>Extracting 1D spectrum<a class="headerlink" href="#extracting-1d-spectrum" title="Link to this heading">¶</a></h1>
<p>This procedure extracts the 1D spectrum from the 2D spectrum (counts vs. spectral pixel).</p>
<p>There are 2 ways in the software to extract the 1D spectrum:</p>
<ol class="arabic simple">
<li><p><strong>Optimal extraction</strong>: This is the default method.</p></li>
<li><p><strong>Summing the counts</strong>: This is done by summing the counts along the spatial axis.</p></li>
</ol>
<p>Both of these are described below.
For details on error estimation, please see the <a class="reference internal" href="uncertainties.html#uncertainties"><span class="std std-ref">note on uncertainties</span></a>.</p>
<section id="optimal-extraction">
<span id="optimal"></span><h2>Optimal extraction<a class="headerlink" href="#optimal-extraction" title="Link to this heading">¶</a></h2>
<p>The routine is called by the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pylongslit_extract_1d<span class="w"> </span>PATH_TO_CONFIG_FILE
</pre></div>
</div>
<p>The routine will extract the 1D spectrum from the 2D spectrum using the optimal extraction method
described in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1986PASP...98..609H/abstract">Horne (1986)</a>.</p>
<p>The optimal extraction algorithm uses the profiles fitted from the <a class="reference internal" href="objtrace.html#objtrace"><span class="std std-ref">object tracing</span></a> routine
to estimate the profile of the object in the spatial direction. The algorithm then weights the counts in the
2D spectrum according to the profile and sums the counts to get the 1D spectrum:</p>
<div class="math notranslate nohighlight">
\[S(p_{\lambda}) = \frac{\sum_{i} P_i(p_{\lambda}) \cdot D_i(p_{\lambda}) / \sigma_i(p_{\lambda})^2}
            {\sum_{i} P_i^2(p_{\lambda}) / \sigma_i(p_{\lambda})^2}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S(p_{\lambda})\)</span> is the extracted 1D spectrum as a function of spectral pixel <span class="math notranslate nohighlight">\(p_{\lambda}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i(p_{\lambda})\)</span> is the spatial profile of the object at spatial pixel <span class="math notranslate nohighlight">\(i\)</span> for spectral pixel <span class="math notranslate nohighlight">\(p_{\lambda}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(D_i(p_{\lambda})\)</span> is the observed data (counts) at spatial pixel <span class="math notranslate nohighlight">\(i\)</span> for spectral pixel <span class="math notranslate nohighlight">\(p_{\lambda}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_i(p_{\lambda})\)</span> is the uncertainty (noise) at spatial pixel <span class="math notranslate nohighlight">\(i\)</span> for spectral pixel <span class="math notranslate nohighlight">\(p_{\lambda}\)</span>.</p></li>
</ul>
<p>The spectrum is then wavelength calibrated using the wavelength solution obtained from the <a class="reference internal" href="wavecalib.html#wavecalib"><span class="std std-ref">wavelength calibration</span></a> routine.</p>
<p>Upon exiting, the routine will display the extracted 1D spectrum
(taken from the SDSS_J213510+2728 example dataset):</p>
<a class="reference internal image-reference" href="_images/1dhorne.png"><img alt="_images/1dhorne.png" class="align-center" src="_images/1dhorne.png" style="width: 100%;" />
</a>
<p>You can use the sliders to crop out any noise at the edges for better visualization.</p>
<p>The extracted 1D spectrum is saved in the output directory specified in the configuration file,
with the filename <code class="docutils literal notranslate"><span class="pre">&quot;1d_science_FILENAME.dat&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;1d_standard_FILENAME.dat&quot;</span></code>.
The files have three columns: wavelength, counts, and variance.</p>
</section>
<section id="summing-the-counts">
<span id="sum"></span><h2>Summing the counts<a class="headerlink" href="#summing-the-counts" title="Link to this heading">¶</a></h2>
<p>This extraction method is more simple than the optimal extraction method.
Generally, you will get the more precise results with less noise using the optimal extraction method.
This method is however useful for edge cases where the object profile needs to be
tightly constrained.</p>
<p>The routine is called by the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pylongslit_extract_simple_1d<span class="w"> </span>PATH_TO_CONFIG_FILE
</pre></div>
</div>
<p>This procedure counts the number of counts in the region defined by the object
center +/- the FWHM of the object.</p>
<p>Firstly, a QA is shown to display this region (from the SDSS_J213510+2728 example dataset):</p>
<a class="reference internal image-reference" href="_images/simple_region.png"><img alt="_images/simple_region.png" class="align-center" src="_images/simple_region.png" style="width: 100%;" />
</a>
<p>Zoomed in:</p>
<a class="reference internal image-reference" href="_images/simple_zoom.png"><img alt="_images/simple_zoom.png" class="align-center" src="_images/simple_zoom.png" style="width: 100%;" />
</a>
<p>If the region is not correct, you should revise the <a class="reference internal" href="objtrace.html#objtrace"><span class="std std-ref">object tracing</span></a> routine.</p>
<p>Then, the software will use <code class="docutils literal notranslate"><span class="pre">&quot;photutils.aperture.RectangularAperture&quot;</span></code> to sum the counts in the region.
You can read the docs for the method at <a class="reference external" href="https://photutils.readthedocs.io/en/2.0.2/api/photutils.aperture.RectangularAperture.html#photutils.aperture.RectangularAperture.do_photometry">photutils</a>.</p>
<p>The spectra are then plotted and saved the same way as in the <a class="reference internal" href="#optimal"><span class="std std-ref">optimal extraction</span></a> routine.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyLongslit</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="getting_started.html">Getting started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#downloading-the-tutorial-data">Downloading the tutorial data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="getting_started.html#tutorial">Tutorial</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="general_notes.html">General Notes on using the pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration_file.html">Configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="bias.html">Bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="dark_current.html">Dark current subtraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="combine_arcs.html">Combinning arc frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="identify.html">Identify arc lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="wavecalib.html">Wavelength Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="flat.html">Flat-field</a></li>
<li class="toctree-l3"><a class="reference internal" href="reduce.html">Reduction of observations</a></li>
<li class="toctree-l3"><a class="reference internal" href="crr.html">Cosmic ray removal</a></li>
<li class="toctree-l3"><a class="reference internal" href="AB.html">A-B Background subtraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="crop.html">Cropping of images</a></li>
<li class="toctree-l3"><a class="reference internal" href="sky.html">Modelled sky subtraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="show_2dspec.html">2D Spectrum Viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="objtrace.html">Object Tracing</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Extracting 1D spectrum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optimal-extraction">Optimal extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summing-the-counts">Summing the counts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sensfunction.html">Sensitivity function</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibrate.html">Flux calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="combine_spec.html">Combining the spectra</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="uncertainties.html">Note on how the software estimates uncertainties</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="getting_started.html">Getting started</a><ul>
      <li>Previous: <a href="objtrace.html" title="previous chapter">Object Tracing</a></li>
      <li>Next: <a href="sensfunction.html" title="next chapter">Sensitivity function</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/extract_1d.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>